@testset ExtendedTestSet "classical_chan_vese" begin
    @testset ExtendedTestSet "classical_chan_vese" begin
        ellipse = [
            -1024 -1024 -1024 200 200 200 200 -1024 -1024 -1024
            -1024 200 200 200 200 200 200 200 200 -1024
            -1024 200 200 200 200 200 200 200 200 -1024
            200 200 200 200 200 200 200 200 200 200
            200 200 200 200 200 200 200 200 200 200
            200 200 200 200 200 200 200 200 200 200
            200 200 200 200 200 200 200 200 200 200
            -1024 200 200 200 200 200 200 200 200 -1024
            -1024 200 200 200 200 200 200 200 200 -1024
            -1024 -1024 -1024 200 200 200 200 -1024 -1024 -1024
        ]
        answer = [
            0 0 0 1 1 1 1 0 0 0
            0 1 1 1 1 1 1 1 1 0
            0 1 1 1 1 1 1 1 1 0
            1 1 1 1 1 1 1 1 1 1
            1 1 1 1 1 1 1 1 1 1
            1 1 1 1 1 1 1 1 1 1
            1 1 1 1 1 1 1 1 1 1
            0 1 1 1 1 1 1 1 1 0
            0 1 1 1 1 1 1 1 1 0
            0 0 0 1 1 1 1 0 0 0
        ]
        phi, iter = ChanVese.classical_chan_vese(ellipse; max_iter=500)
        seg = phi .> 0
        @test seg == answer
    end
end
